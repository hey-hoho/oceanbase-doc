# CREATE TENANT

## 描述

`CREATE TENANT` 语句用于创建用户租户。OceanBase 数据库仅支持创建用户租户，系统租户为集群创建时系统自动创建；Meta 租户是 OceanBase 数据库内部自管理的租户，每创建一个用户租户会创建一个对应的 Meta 租户，其生命周期与用户租户保持一致。

通过 `CREATE TENANT` 语句创建的租户，默认其租户角色为 `PRIMARY`。

## 使用限制及注意事项

* OceanBase 数据库支持两种类型的租户，MySQL 兼容模式和 Oracle 兼容模式。创建租户时，需要指定合适的租户的类型。租户创建后，租户类型无法修改。

* 创建租户时需要为租户分配资源池，请提前做好资源规划并创建好资源池，创建资源池的相关操作请参见 [创建租户](../../../../600.manage/200.tenant-management/600.common-tenant-operations/200.manage-create-tenant.md)。

## 权限要求

仅 `sys` 租户的 `root` 用户（`root@sys`）可以创建租户，其他租户不支持创建租户。

## 语法

创建租户的语法如下：

```sql
CREATE TENANT [IF NOT EXISTS] tenant_name 
     [tenant_option_list] [opt_set_sys_var];

tenant_option_list: 
  tenant_option [, tenant_option...]

tenant_option:  
      LOCALITY [=] 'locality description' [FORCE] 
    | PRIMARY_ZONE [=] primary_zone_name 
    | RESOURCE_POOL_LIST [=] (resource_pool_list) 
    | ENABLE_ARBITRATION_SERVICE [=] {true | false} 
    | {CHARACTER SET | CHARSET} [=] charset_name 
    | COLLATE [=] collation_name 
    | {READ ONLY | READ WRITE}
    | COMMENT [=] 'string' 
    | [DEFAULT] TABLEGROUP [=] {NULL | tablegroup_name} 
    | PROGRESSIVE_MERGE_NUM [=] INTNUM 
    | ENABLE_EXTENDED_ROWID [=] {true | false} 

primary_zone_name:  
      DEFAULT 
    | RANDOM 
    | USER_VARIABLE 
    | zone_name

resource_pool_list:
      pool_name [, pool_name...]

opt_set_sys_var:
      SET sys_var_and_val_list
    | SET VARIABLES sys_var_and_val_list  
    | VARIABLES sys_var_and_val_list

sys_var_and_val_list:  
      sys_var_and_val [, sys_var_and_val...]

sys_var_and_val:  
      var_name SET_VAR {expr | ON | BINARY | DEFAULT}
    | var_name {TO | =} {expr | ON | BINARY | DEFAULT}
```

## 参数说明

|          **参数**          |                **描述**                |
|--------------------------|---------------------------------|
| tenant_name              | 指定租户名。最长 128 个字符，只能有大小写英文字母，数字和下划线，而且必须以字母或下划线开头，并且不能是 OceanBase 数据库的关键字。 |
| IF NOT EXISTS            | 如果要创建的租户名已存在，并且没有指定 `IF NOT EXISTS`，则会报错。    |
| RESOURCE_POOL_LIST       | 资源池列表，为创建租户时的必填项。  |
| DEFAULT TABLEGROUP       | 设置租户默认表组信息，`NULL` 表示取消默认表组。 如果不指定，默认为 `NULL`。    |
| COMMENT                  | 指定注释。   |
| CHARACTER SET \| CHARSET | 指定字符集。   |
| COLLATE                  | 指定字符序。  |
| PRIMARY_ZONE             | 指定租户所在的 Primary Zone 名称。  |
| LOCALITY                 | 描述副本在 Zone 间的分布情况。 例如：`F@z1,F@z2,F@z3` 表示 `z1`、`z2`、`z3` 为全功能副本。     |
| system_var_name          | 指定租户系统变量值。其中，`ob_compatibility_mode` 用于指定租户的兼容模式（可选 MySQL 或 Oracle 模式），而且只能在创建时指定；如果不指定 `ob_compatibility_mode`，默认兼容模式为 MySQL；`lower_case_table_names` 用于控制大小写敏感，仅支持使用 `CREATE TENANT` 语句创建租户时指定并只在 MySQL 模式下生效，租户创建后不能通过 SQL 语句修改。 |
| STANDBY | 创建备租户。此命令执行成功后，备租户将自动进入持续同步状态。|
| LOG_RESTORE_SOURCE | 日志恢复源配置，详细信息参见 [设置日志恢复源](200.alter-system/2600.log-restore-source.md)。 |

## 示例

* 创建一个 3 副本的 MySQL 租户。

  ```sql
  obclient> CREATE TENANT IF NOT EXISTS test_tenant CHARSET='utf8mb4', ZONE_LIST=('zone1','zone2','zone3'), PRIMARY_ZONE='zone1;zone2,zone3', RESOURCE_POOL_LIST=('pool1');
  ```

* 创建 Oracle 兼容模式租户。

  ```sql
  obclient> CREATE TENANT IF NOT EXISTS tenant1 ZONE_LIST=('zone1'), PRIMARY_ZONE='zone1', RESOURCE_POOL_LIST=('pool1') SET ob_compatibility_mode='oracle', set ob_tcp_invited_nodes='%';
  ```
	
## 相关文档

* [租户介绍](../../../../600.manage/200.tenant-management/100.tenant-introduction.md)

* [用户租户介绍](../../../../600.manage/200.tenant-management/400.introduction-of-user-tenant.md)

* [创建租户](../../../../600.manage/200.tenant-management/600.common-tenant-operations/200.manage-create-tenant.md)

